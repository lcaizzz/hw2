---
title: "hw2"
author: "Le Cai"
date: "2024-10-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
     
```



```{r}
library(tidyverse)
library(readr)
library(shiny)
#library(glue)
#library(bslib)
library(DT)
library(ggplot2)
library(plotly)
data <- read_csv("https://uwmadison.box.com/shared/static/z6aapq6uw92xg4a31f96w9wd08fonv1j.csv")
```


```{r}
 scatterplot <- function(df) {
   p <- ggplot(mapping = aes(lng, lat)) +
     geom_point(data = df %>% filter(selected), color='red', size = 2, alpha = 1) +
     geom_point(data = df %>% filter(!selected),  size = .5, alpha = .1)
   ggplotly(p, tooltip = "Title") %>%
     style(hoveron = "fill")
 }

filter_df <- function(df) {
  filter(df,selected) |>
    select(rank, year, location, country, restaurant)}
  
  
ui <- fluidPage(
   titlePanel("Worlds Best Restaurants"),
   numericInput("rank", "Enter the rank between 1 to 50)", 1),
   sliderInput("year", "Year", min = min(data$year), max = max(data$year), c(2002, 2023), sep = ""),
   plotlyOutput("scatter"),
   DTOutput("dt")
 )
server <- function(input, output) {
   data_subset <- reactive({
     data %>%
       mutate(selected = (
         (rank %in% input$rank) &
         (year >= input$year[1]) &
         (year <= input$year[2])
       ))
   })
   output$scatter <- renderPlotly({
     scatterplot(data_subset())
   })
   output$dt <- renderDT(filter_df(data_subset()))
 }
 
shinyApp(ui, server)


```



